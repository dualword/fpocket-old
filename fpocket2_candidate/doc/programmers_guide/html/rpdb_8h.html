<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>fpocket: rpdb.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<img src="fpocket_logo_small.png" width="545" height="150">
<!-- Generated by Doxygen 1.5.9 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>rpdb.h File Reference</h1><code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &quot;<a class="el" href="atom_8h_source.html">atom.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="pertable_8h_source.html">pertable.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="utils_8h_source.html">utils.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="memhandler_8h_source.html">memhandler.h</a>&quot;</code><br>

<p>
<a href="rpdb_8h_source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structs__pdb.html">s_pdb</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#81915efba694ad7576ecf5768b66a318">M_PDB_LINE_LEN</a>&nbsp;&nbsp;&nbsp;80</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#ce73bc2986adaa1837bc97e2757f1bb5">M_PDB_BUF_LEN</a>&nbsp;&nbsp;&nbsp;83</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#66a6a8deb20e74fd1fd4e597b46ead20">M_KEEP_LIG</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#067223f2b95bbd02c1861d7d45f393b7">M_DONT_KEEP_LIG</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#6a662906aeb994f88da61ce8c10c24e2">M_PDB_HEADER</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#d2e88a301b4e69f14751af7943c260a4">M_PDB_REMARK</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#b210f9726c2add7170abc7e6b2aaaf1b">M_PDB_ATOM</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#8a6622d3698f1a293e65c953143f71c2">M_PDB_CONECT</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#b9b762ebf107706f05aa1e1fb024d295">M_PDB_HETATM</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#283ef820cc07bf2cbe4a428dfe4ba179">M_PDB_CRYST1</a>&nbsp;&nbsp;&nbsp;6</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#0d54a13b6c03afce45f81b4c34d15c75">M_PDB_EOF</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#5bfc1456a8ee3845a2268fab5274c38f">M_PDB_END</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#157c1a38e32066dcb479c094ada269c6">M_PDB_UNKNOWN</a>&nbsp;&nbsp;&nbsp;9</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structs__pdb.html">s_pdb</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#29ed3bff6fdc59fd8bf806a35c3127d7">rpdb_open</a> (char *fpath, const char *ligan, const int keep_lig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#1ec399102f369c72b06a9944616715b0">rpdb_read</a> (<a class="el" href="structs__pdb.html">s_pdb</a> *pdb, const char *ligan, const int keep_lig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a> (char *pdb_line, char *res_name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#3300a3ed9f0b36062e6a79ffb2e1d316">guess_element</a> (char *aname, char *element)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#405dcce22af035cda56e6fe45cd822be">rpdb_extract_cryst1</a> (char *rstr, float *alpha, float *beta, float *gamma, float *a, float *b, float *c)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#602648853ffc0de335f2d065f74f5353">rpdb_extract_atom_values</a> (char *pdb_line, float *x, float *y, float *z, float *occ, float *beta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a> (char *pdb_line, char *type, int *atm_id, char *name, char *alt_loc, char *res_name, char *chain, int *res_id, char *insert, float *x, float *y, float *z, float *occ, float *bfactor, char *symbol, int *charge, int *guess_flag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8h.html#fda283d39ae56654675e9e858f5ffdea">free_pdb_atoms</a> (<a class="el" href="structs__pdb.html">s_pdb</a> *pdb)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="067223f2b95bbd02c1861d7d45f393b7"></a><!-- doxytag: member="rpdb.h::M_DONT_KEEP_LIG" ref="067223f2b95bbd02c1861d7d45f393b7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_DONT_KEEP_LIG&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Don't keep ligand flag 
<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00050">50</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

<p>Referenced by <a class="el" href="check_8c_source.html#l00105">check_fpocket()</a>, <a class="el" href="dpocket_8c_source.html#l00184">desc_pocket()</a>, <a class="el" href="fpmain_8c_source.html#l00129">process_pdb()</a>, and <a class="el" href="tpocket_8c_source.html#l00440">test_set()</a>.</p>

</div>
</div><p>
<a class="anchor" name="66a6a8deb20e74fd1fd4e597b46ead20"></a><!-- doxytag: member="rpdb.h::M_KEEP_LIG" ref="66a6a8deb20e74fd1fd4e597b46ead20" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_KEEP_LIG&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Keep ligand flag 
<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00049">49</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

<p>Referenced by <a class="el" href="dpocket_8c_source.html#l00184">desc_pocket()</a>, and <a class="el" href="tpocket_8c_source.html#l00440">test_set()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b210f9726c2add7170abc7e6b2aaaf1b"></a><!-- doxytag: member="rpdb.h::M_PDB_ATOM" ref="b210f9726c2add7170abc7e6b2aaaf1b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_ATOM&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00054">54</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="ce73bc2986adaa1837bc97e2757f1bb5"></a><!-- doxytag: member="rpdb.h::M_PDB_BUF_LEN" ref="ce73bc2986adaa1837bc97e2757f1bb5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_BUF_LEN&nbsp;&nbsp;&nbsp;83          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
size need to buffer + CR, LF, and NUL 
<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00047">47</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c_source.html#l00512">rpdb_open()</a>, and <a class="el" href="rpdb_8c_source.html#l00628">rpdb_read()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8a6622d3698f1a293e65c953143f71c2"></a><!-- doxytag: member="rpdb.h::M_PDB_CONECT" ref="8a6622d3698f1a293e65c953143f71c2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_CONECT&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00055">55</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="283ef820cc07bf2cbe4a428dfe4ba179"></a><!-- doxytag: member="rpdb.h::M_PDB_CRYST1" ref="283ef820cc07bf2cbe4a428dfe4ba179" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_CRYST1&nbsp;&nbsp;&nbsp;6          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00057">57</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="5bfc1456a8ee3845a2268fab5274c38f"></a><!-- doxytag: member="rpdb.h::M_PDB_END" ref="5bfc1456a8ee3845a2268fab5274c38f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_END&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00059">59</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="0d54a13b6c03afce45f81b4c34d15c75"></a><!-- doxytag: member="rpdb.h::M_PDB_EOF" ref="0d54a13b6c03afce45f81b4c34d15c75" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_EOF&nbsp;&nbsp;&nbsp;7          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00058">58</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="6a662906aeb994f88da61ce8c10c24e2"></a><!-- doxytag: member="rpdb.h::M_PDB_HEADER" ref="6a662906aeb994f88da61ce8c10c24e2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_HEADER&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00052">52</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="b9b762ebf107706f05aa1e1fb024d295"></a><!-- doxytag: member="rpdb.h::M_PDB_HETATM" ref="b9b762ebf107706f05aa1e1fb024d295" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_HETATM&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00056">56</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="81915efba694ad7576ecf5768b66a318"></a><!-- doxytag: member="rpdb.h::M_PDB_LINE_LEN" ref="81915efba694ad7576ecf5768b66a318" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_LINE_LEN&nbsp;&nbsp;&nbsp;80          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
actual record size 
<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00046">46</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c_source.html#l00512">rpdb_open()</a>, and <a class="el" href="rpdb_8c_source.html#l00628">rpdb_read()</a>.</p>

</div>
</div><p>
<a class="anchor" name="d2e88a301b4e69f14751af7943c260a4"></a><!-- doxytag: member="rpdb.h::M_PDB_REMARK" ref="d2e88a301b4e69f14751af7943c260a4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_REMARK&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00053">53</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="157c1a38e32066dcb479c094ada269c6"></a><!-- doxytag: member="rpdb.h::M_PDB_UNKNOWN" ref="157c1a38e32066dcb479c094ada269c6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PDB_UNKNOWN&nbsp;&nbsp;&nbsp;9          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8h_source.html#l00060">60</a> of file <a class="el" href="rpdb_8h_source.html">rpdb.h</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="fda283d39ae56654675e9e858f5ffdea"></a><!-- doxytag: member="rpdb.h::free_pdb_atoms" ref="fda283d39ae56654675e9e858f5ffdea" args="(s_pdb *pdb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_pdb_atoms           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__pdb.html">s_pdb</a> *&nbsp;</td>
          <td class="paramname"> <em>pdb</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: free_pdb_atoms<p>
## SPECIFICATION: Free memory for <a class="el" href="structs__pdb.html">s_pdb</a> structure<p>
## PARAMETRES: @ <a class="el" href="structs__pdb.html">s_pdb</a> *pdb: pdb struct to free<p>
## RETURN: void 
<p>Definition at line <a class="el" href="rpdb_8c_source.html#l00801">801</a> of file <a class="el" href="rpdb_8c_source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="rpdb_8h_source.html#l00070">s_pdb::fpdb</a>, <a class="el" href="rpdb_8h_source.html#l00076">s_pdb::latm_lig</a>, <a class="el" href="rpdb_8h_source.html#l00072">s_pdb::latoms</a>, <a class="el" href="rpdb_8h_source.html#l00074">s_pdb::latoms_p</a>, <a class="el" href="rpdb_8h_source.html#l00075">s_pdb::lhetatm</a>, and <a class="el" href="memhandler_8c_source.html#l00255">my_free()</a>.</p>

<p>Referenced by <a class="el" href="dpocket_8c_source.html#l00184">desc_pocket()</a>, and <a class="el" href="tpocket_8c_source.html#l00440">test_set()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00802"></a>00802 {
<a name="l00803"></a>00803         <span class="keywordflow">if</span>(pdb) {
<a name="l00804"></a>00804                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a>) {
<a name="l00805"></a>00805                         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a>) ;
<a name="l00806"></a>00806                         pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a> = NULL ;           
<a name="l00807"></a>00807                 }
<a name="l00808"></a>00808                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a>) {
<a name="l00809"></a>00809                         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a>) ;
<a name="l00810"></a>00810                         pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a> = NULL ;
<a name="l00811"></a>00811                 }
<a name="l00812"></a>00812                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a>) {
<a name="l00813"></a>00813                         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a>) ; 
<a name="l00814"></a>00814                         pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a> = NULL ;
<a name="l00815"></a>00815                 }
<a name="l00816"></a>00816                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>) {
<a name="l00817"></a>00817                         fclose(pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>) ;
<a name="l00818"></a>00818                         pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a> = NULL ;      
<a name="l00819"></a>00819                 }
<a name="l00820"></a>00820                 
<a name="l00821"></a>00821                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a>) {
<a name="l00822"></a>00822                         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a>) ;
<a name="l00823"></a>00823                         pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a> = NULL ;
<a name="l00824"></a>00824                 }
<a name="l00825"></a>00825 
<a name="l00826"></a>00826                 <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb) ;
<a name="l00827"></a>00827         }
<a name="l00828"></a>00828 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3300a3ed9f0b36062e6a79ffb2e1d316"></a><!-- doxytag: member="rpdb.h::guess_element" ref="3300a3ed9f0b36062e6a79ffb2e1d316" args="(char *aname, char *element)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void guess_element           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>aname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>element</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: guess_element<p>
## SPECIFICATION: Guess the element of the atom based on atom name. The pattern matched here have been taken from the MOE PDB reader.<p>
' CL#' =&gt; Chlorine (use El field if it matches ' @?' &amp;&amp; HETATAM) CH2T from CT !!! =&gt; what not<p>
const AtomPatterns = [ N:'[A-G,I-L,N-Z]N#*', O:['[A-B,D-G,I-L,N-Z]O*','OP[A-C]#','CO[A-Z,0-9]*','OE##'], P:'[A-G,I-K,M-N,P-Z]P*', C:['[A-G,I-Z]C#*','C[B-G,I-K,M,P-T,V-Z]#*','CH#', 'BC '], H:['H[0-9,A-E,H-Z]*','#[0-9,A-Z]H*','?H[A-Z,0-9]*', 'HG##'], CL:'CL#', // check this S:'[P,N]S#*', SE:'NSE1' ];<p>
## PARAMETRES: @ char *atom_name : The atom name @ char *res_name : OUTPUT the element guessed<p>
## RETURN: void (element is the output) 
<p>Definition at line <a class="el" href="rpdb_8c_source.html#l00274">274</a> of file <a class="el" href="rpdb_8c_source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="pertable_8c_source.html#l00258">is_valid_element()</a>, and <a class="el" href="utils_8c_source.html#l00475">str_trim()</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c_source.html#l00156">rpdb_extract_pdb_atom()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00275"></a>00275 {
<a name="l00276"></a>00276         <span class="comment">/* Use a temporary variable for atomname, mainly to remove spaces */</span>
<a name="l00277"></a>00277         <span class="keywordtype">char</span> tmp[strlen(aname)+1] ;
<a name="l00278"></a>00278         strcpy(tmp, aname) ;
<a name="l00279"></a>00279         
<a name="l00280"></a>00280         <a class="code" href="utils_8c.html#ed930c5e93a75d90a96195282790d467">str_trim</a>(tmp) ;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282         <span class="keywordtype">char</span> *ptmp = tmp ;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284         <span class="comment">/* Move to the second caracter if we find a number */</span> 
<a name="l00285"></a>00285         <span class="keywordflow">if</span>(isdigit(tmp[0])) {
<a name="l00286"></a>00286             ptmp = ptmp+1 ;
<a name="l00287"></a>00287         }
<a name="l00288"></a>00288         <span class="keywordflow">else</span> {
<a name="l00289"></a>00289             element[0] = <span class="charliteral">' '</span>;
<a name="l00290"></a>00290             element[1] = ptmp[0] ;
<a name="l00291"></a>00291             element[2] = <span class="charliteral">'\0'</span>;
<a name="l00292"></a>00292             <span class="keywordflow">return</span>;
<a name="l00293"></a>00293         }
<a name="l00294"></a>00294         <span class="comment">/* Check if its a valid element */</span>
<a name="l00295"></a>00295         <span class="keywordtype">int</span> index = <a class="code" href="pertable_8c.html#6b05e53b42f5fe5907683fddc430cd39">is_valid_element</a>(ptmp, 1) ;
<a name="l00296"></a>00296         <span class="keywordflow">if</span>(index != -1) {
<a name="l00297"></a>00297                 strcpy(element, ptmp );
<a name="l00298"></a>00298                 return ;
<a name="l00299"></a>00299         }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301         <span class="comment">/* Here we have a special case... So take the first and second */</span>
<a name="l00302"></a>00302         element[0] = <span class="charliteral">' '</span>;
<a name="l00303"></a>00303         element[1] = ptmp[0] ;
<a name="l00304"></a>00304         element[2] = <span class="charliteral">'\0'</span>;
<a name="l00305"></a>00305 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c4a87e3d2d6acef7bcadce143d4fa541"></a><!-- doxytag: member="rpdb.h::rpdb_extract_atm_resname" ref="c4a87e3d2d6acef7bcadce143d4fa541" args="(char *pdb_line, char *res_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rpdb_extract_atm_resname           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pdb_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>res_name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_extract_atm_resname<p>
## SPECIFICATION: Extract the residu name for an ATOM or HETATM pdb record. To remember:<p>
COLUMNS DATA TYPE FIELD DEFINITION<p>
18 - 20 Residue name resName Residue name.<p>
The memory to store the name has to be provided by the user.<p>
## PARAMETRES: @ char *pdb_line : The PDB line containings info @ char *res_name : Pointer to residue name<p>
## RETURN: void 
<p>Definition at line <a class="el" href="rpdb_8c_source.html#l00366">366</a> of file <a class="el" href="rpdb_8c_source.html">rpdb.c</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c_source.html#l00156">rpdb_extract_pdb_atom()</a>, <a class="el" href="rpdb_8c_source.html#l00512">rpdb_open()</a>, and <a class="el" href="rpdb_8c_source.html#l00628">rpdb_read()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00367"></a>00367 {
<a name="l00368"></a>00368 <span class="comment">/* Position:          1         2         3         4         5         6 */</span>
<a name="l00369"></a>00369 <span class="comment">/* Position: 123456789012345678901234567890123456789012345678901234567890 */</span>
<a name="l00370"></a>00370 <span class="comment">/* Record:   ATOM    145  N   VAL A  25      32.433  16.336  57.540  1.00 */</span>
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="comment">/* Position: 6         7         8 */</span>
<a name="l00373"></a>00373 <span class="comment">/* Position: 012345678901234567890 */</span>
<a name="l00374"></a>00374 <span class="comment">/* Record:   0 11.92           N   */</span>
<a name="l00375"></a>00375         
<a name="l00376"></a>00376 <span class="comment">/* Residue name */</span>
<a name="l00377"></a>00377         strncpy(res_name, pdb_line + 17, 4);
<a name="l00378"></a>00378         res_name[4] = <span class="charliteral">'\0'</span>;
<a name="l00379"></a>00379         <span class="comment">/*str_trim(res_name); */</span>
<a name="l00380"></a>00380 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="602648853ffc0de335f2d065f74f5353"></a><!-- doxytag: member="rpdb.h::rpdb_extract_atom_values" ref="602648853ffc0de335f2d065f74f5353" args="(char *pdb_line, float *x, float *y, float *z, float *occ, float *beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rpdb_extract_atom_values           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pdb_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>occ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>bfactor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_extract_atom_values<p>
## SPECIFICATION: Extract coordinates, occupancy and bfactor values from a pdb ATOM or HETATM line, and store them in given pointers.<p>
## PARAMETRES: @ char *pdb_line : The PDB line containings info @ float *x, *y, *z : Pointer to coordinates @ float *occ : Pointer to occupency @ float *bfactor : Pointer to b-factor<p>
## RETURN: void 
<p>Definition at line <a class="el" href="rpdb_8c_source.html#l00399">399</a> of file <a class="el" href="rpdb_8c_source.html">rpdb.c</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c_source.html#l00156">rpdb_extract_pdb_atom()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00401"></a>00401 {
<a name="l00402"></a>00402 <span class="comment">/* Position:          1         2         3         4         5         6 */</span>
<a name="l00403"></a>00403 <span class="comment">/* Position: 123456789012345678901234567890123456789012345678901234567890 */</span>
<a name="l00404"></a>00404 <span class="comment">/* Record:   ATOM    145  N   VAL A  25      32.433  16.336  57.540  1.00 */</span>
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 <span class="comment">/* Position: 6         7         8 */</span>
<a name="l00407"></a>00407 <span class="comment">/* Position: 012345678901234567890 */</span>
<a name="l00408"></a>00408 <span class="comment">/* Record:   0 11.92           N   */</span>
<a name="l00409"></a>00409         
<a name="l00410"></a>00410         <span class="keywordtype">char</span> *ptr,
<a name="l00411"></a>00411                  ctmp ;
<a name="l00412"></a>00412         
<a name="l00413"></a>00413         ptr = pdb_line + 30 ;
<a name="l00414"></a>00414         ctmp = pdb_line[38] ; pdb_line[38] = <span class="charliteral">'\0'</span> ;
<a name="l00415"></a>00415         *x = (float) atof(ptr) ; pdb_line[38] = ctmp ;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417         ptr = pdb_line + 38 ;
<a name="l00418"></a>00418         ctmp = pdb_line[46] ; pdb_line[46] = <span class="charliteral">'\0'</span> ;
<a name="l00419"></a>00419         *y = (float) atof(ptr) ; pdb_line[46] = ctmp ;
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         ptr = pdb_line + 46 ;
<a name="l00422"></a>00422         ctmp = pdb_line[54] ; pdb_line[54] = <span class="charliteral">'\0'</span> ;
<a name="l00423"></a>00423         *z = (float) atof(ptr) ; pdb_line[54] = ctmp ;
<a name="l00424"></a>00424 
<a name="l00425"></a>00425         ptr = pdb_line + 54 ;
<a name="l00426"></a>00426         ctmp = pdb_line[60] ; pdb_line[60] = <span class="charliteral">'\0'</span> ;
<a name="l00427"></a>00427         *occ = (float) atof(ptr) ; pdb_line[60] = ctmp ;
<a name="l00428"></a>00428         
<a name="l00429"></a>00429         ptr = pdb_line + 60 ;
<a name="l00430"></a>00430         ctmp = pdb_line[66] ; pdb_line[66] = <span class="charliteral">'\0'</span> ;
<a name="l00431"></a>00431         *bfactor = (float) atof(ptr) ; pdb_line[66] = ctmp ;
<a name="l00432"></a>00432 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="405dcce22af035cda56e6fe45cd822be"></a><!-- doxytag: member="rpdb.h::rpdb_extract_cryst1" ref="405dcce22af035cda56e6fe45cd822be" args="(char *rstr, float *alpha, float *beta, float *gamma, float *a, float *b, float *c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rpdb_extract_cryst1           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pdb_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>c</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_extract_cryst1<p>
## SPECIFICATION: Extract information on a box size from a pdb CRYSTL line, and store them in given pointers.<p>
## PARAMETRES: @ char *pdb_line : The PDB line containings info @ float *alpha, *beta, *gamma : Pointer to angles @ float *A, B, C : Pointer sides length<p>
## RETURN: void 
<p>Definition at line <a class="el" href="rpdb_8c_source.html#l00450">450</a> of file <a class="el" href="rpdb_8c_source.html">rpdb.c</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c_source.html#l00628">rpdb_read()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00452"></a>00452 {
<a name="l00453"></a>00453 <span class="comment">/* Position:          1         2         3         4         5         6 */</span>
<a name="l00454"></a>00454 <span class="comment">/* Position: 123456789012345678901234567890123456789012345678901234567890 */</span>
<a name="l00455"></a>00455 <span class="comment">/* Record:   ATOM    145  N   VAL A  25      32.433  16.336  57.540  1.00 */</span>
<a name="l00456"></a>00456 
<a name="l00457"></a>00457 <span class="comment">/* Position: 6         7         8 */</span>
<a name="l00458"></a>00458 <span class="comment">/* Position: 012345678901234567890 */</span>
<a name="l00459"></a>00459 <span class="comment">/* Record:   0 11.92           N   */</span>
<a name="l00460"></a>00460 
<a name="l00461"></a>00461         <span class="keywordtype">char</span> ch, *s;
<a name="l00462"></a>00462         
<a name="l00463"></a>00463         s = pdb_line+6 ;
<a name="l00464"></a>00464         ch = pdb_line[15] ; pdb_line[15] = <span class="charliteral">'\0'</span> ;
<a name="l00465"></a>00465         *a = (float) atof(s) ;
<a name="l00466"></a>00466 
<a name="l00467"></a>00467         s = pdb_line+15 ;
<a name="l00468"></a>00468         *s = ch ; ch = pdb_line[24]; pdb_line[24] = <span class="charliteral">'\0'</span> ;
<a name="l00469"></a>00469         *b = (float) atof(s) ;
<a name="l00470"></a>00470 
<a name="l00471"></a>00471         s = pdb_line+24 ;
<a name="l00472"></a>00472         *s = ch; ch = pdb_line[33]; pdb_line[33] = <span class="charliteral">'\0'</span> ;
<a name="l00473"></a>00473         *c = (float) atof(s) ;
<a name="l00474"></a>00474 
<a name="l00475"></a>00475         s = pdb_line+33;
<a name="l00476"></a>00476         *s = ch; ch = pdb_line[40]; pdb_line[40] = <span class="charliteral">'\0'</span> ;
<a name="l00477"></a>00477         *alpha = (float) atof(s) ;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479         s = pdb_line+40;
<a name="l00480"></a>00480         *s = ch; ch = pdb_line[47]; pdb_line[47] = <span class="charliteral">'\0'</span> ;
<a name="l00481"></a>00481         *beta = (float) atof(s) ;
<a name="l00482"></a>00482 
<a name="l00483"></a>00483         s = pdb_line+47;
<a name="l00484"></a>00484         *s = ch; ch = pdb_line[54]; pdb_line[54] = <span class="charliteral">'\0'</span> ;
<a name="l00485"></a>00485         *gamma = (float) atof(s) ;
<a name="l00486"></a>00486 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5e4cbe79a2e0cbd44f343846934ec2bd"></a><!-- doxytag: member="rpdb.h::rpdb_extract_pdb_atom" ref="5e4cbe79a2e0cbd44f343846934ec2bd" args="(char *pdb_line, char *type, int *atm_id, char *name, char *alt_loc, char *res_name, char *chain, int *res_id, char *insert, float *x, float *y, float *z, float *occ, float *bfactor, char *symbol, int *charge, int *guess_flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rpdb_extract_pdb_atom           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pdb_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>atm_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>alt_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>res_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>res_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>insert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>occ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>bfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>symbol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>guess_flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_extract_pdb_atom<p>
## SPECIFICATION: Extract all information given in a pdb ATOM or HETATM line, and store them in given pointers. User must therefore provide enough memory in parameter. PDB last known standart:<p>
COLUMNS DATA TYPE FIELD DEFINITION<p>
1 - 6 Record name "ATOM    " 7 - 11 Integer serial Atom serial number. 13 - 16 Atom name Atom name. 17 Character altLoc Alternate location indicator. 18 - 20 Residue name resName Residue name. 22 Character chainID Chain identifier. 23 - 26 Integer resSeq Residue sequence number. 27 AChar iCode Code for insertion of residues. 31 - 38 Real(8.3) x Orthogonal coordinates for X in Angstroms 39 - 46 Real(8.3) y Orthogonal coordinates for Y in Angstroms 47 - 54 Real(8.3) z Orthogonal coordinates for Z in Angstroms 55 - 60 Real(6.2) occupancy Occupancy. 61 - 66 Real(6.2) tempFactor Temperature factor. 77 - 78 LString(2) element Element symbol, right-justified. 79 - 80 LString(2) charge Charge on the atom.<p>
## PARAMETRES: @ char *pdb_line : The PDB line containings info @ int *atm_id : Pointer to atom ID @ char *name : Pointer to atom name @ char *res_name : Pointer to residue name @ char *chain : Pointer to chain name @ char *seg_name : Pointer to segment @ int *res_id : Pointer to residue ID @ char *insert : Pointer to insertion code @ char *alt_loc : Pointer to alternate location @ char *elem_symbol : Pointer to element symbol @ float *x, *y, *z : Pointer to coordinates @ float *occ : Pointer to occupency @ float *bfactor : Pointer to b-factor @ char *symbol : Pointer to symbol @ float *bfactor : Pointer to charge @ int guess_flag : Flag if elements were guessed<p>
## RETURN: void 
<p>Definition at line <a class="el" href="rpdb_8c_source.html#l00156">156</a> of file <a class="el" href="rpdb_8c_source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="rpdb_8c_source.html#l00274">guess_element()</a>, <a class="el" href="rpdb_8c_source.html#l00366">rpdb_extract_atm_resname()</a>, <a class="el" href="rpdb_8c_source.html#l00399">rpdb_extract_atom_values()</a>, and <a class="el" href="utils_8c_source.html#l00475">str_trim()</a>.</p>

<p>Referenced by <a class="el" href="check_8c_source.html#l00412">load_pdb_line()</a>, and <a class="el" href="rpdb_8c_source.html#l00628">rpdb_read()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00161"></a>00161 {
<a name="l00162"></a>00162 <span class="comment">/* Position:          1         2         3         4         5         6 */</span>
<a name="l00163"></a>00163 <span class="comment">/* Position: 123456789012345678901234567890123456789012345678901234567890 */</span>
<a name="l00164"></a>00164 <span class="comment">/* Record:   ATOM    145  N   VAL A  25      32.433  16.336  57.540  1.00 */</span>
<a name="l00165"></a>00165 
<a name="l00166"></a>00166 <span class="comment">/* Position: 6         7         8 */</span>
<a name="l00167"></a>00167 <span class="comment">/* Position: 012345678901234567890 */</span>
<a name="l00168"></a>00168 <span class="comment">/* Record:   0 11.92           N   */</span>
<a name="l00169"></a>00169 
<a name="l00170"></a>00170         <span class="keywordtype">int</span> rlen = strlen(pdb_line) ;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172         <span class="keywordtype">char</span> *prt,
<a name="l00173"></a>00173                  ctmp ;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175         <span class="comment">/* Record type */</span>
<a name="l00176"></a>00176         strncpy(type, pdb_line, 6) ;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178         <span class="comment">/* Atom ID */</span>
<a name="l00179"></a>00179         prt = pdb_line + 6 ; 
<a name="l00180"></a>00180         ctmp = pdb_line[11] ; pdb_line[11] = <span class="charliteral">'\0'</span> ;
<a name="l00181"></a>00181         *atm_id = atoi(prt) ; pdb_line[11] = ctmp ;
<a name="l00182"></a>00182         
<a name="l00183"></a>00183         <span class="comment">/* Atom name */</span>
<a name="l00184"></a>00184         strncpy(name, pdb_line + 12, 4);
<a name="l00185"></a>00185         name[4] = <span class="charliteral">'\0'</span>;
<a name="l00186"></a>00186         <a class="code" href="utils_8c.html#ed930c5e93a75d90a96195282790d467">str_trim</a>(name) ;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188         <span class="comment">/* Alternate location identifier */</span>
<a name="l00189"></a>00189         *alt_loc = pdb_line[16] ;
<a name="l00190"></a>00190         
<a name="l00191"></a>00191         <span class="comment">/* Residue name */</span>
<a name="l00192"></a>00192         <a class="code" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a>(pdb_line, res_name) ;
<a name="l00193"></a>00193 
<a name="l00194"></a>00194         <span class="comment">/* Chain name */</span>
<a name="l00195"></a>00195         chain[0] = pdb_line[21];
<a name="l00196"></a>00196         chain[1] = <span class="charliteral">'\0'</span>;
<a name="l00197"></a>00197 
<a name="l00198"></a>00198         <span class="comment">/* Residue id number */</span>
<a name="l00199"></a>00199         prt = pdb_line + 22 ; 
<a name="l00200"></a>00200         ctmp = pdb_line[26] ; pdb_line[26] = <span class="charliteral">'\0'</span> ;
<a name="l00201"></a>00201         *res_id = atoi(prt) ; pdb_line[26] = ctmp ;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203         <span class="comment">/* Insertion code */</span>
<a name="l00204"></a>00204         *insert = pdb_line[26];
<a name="l00205"></a>00205 
<a name="l00206"></a>00206         <span class="comment">/* x, y, and z coordinates, occupancy and b-factor */</span>
<a name="l00207"></a>00207         <a class="code" href="rpdb_8c.html#8710b47d0170823a5d757d3f2ebf43c0">rpdb_extract_atom_values</a>(pdb_line, x, y, z, occ, bfactor);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209         <span class="comment">/* Atomic element symbol (if does not exists, guess it based on</span>
<a name="l00210"></a>00210 <span class="comment">         * atom name */</span>
<a name="l00211"></a>00211         <span class="keywordflow">if</span> (rlen &gt;= 77) {
<a name="l00212"></a>00212                 strncpy(symbol, pdb_line + 76, 2);
<a name="l00213"></a>00213                 symbol[2] = <span class="charliteral">'\0'</span>;
<a name="l00214"></a>00214                 <a class="code" href="utils_8c.html#ed930c5e93a75d90a96195282790d467">str_trim</a>(symbol); <span class="comment">/* remove spaces */</span>
<a name="l00215"></a>00215                 <span class="keywordflow">if</span>(strlen(symbol) &lt; 1) {
<a name="l00216"></a>00216                         <a class="code" href="rpdb_8c.html#3300a3ed9f0b36062e6a79ffb2e1d316">guess_element</a>(name, symbol) ;
<a name="l00217"></a>00217                         *guess_flag+=1;
<a name="l00218"></a>00218                 }
<a name="l00219"></a>00219         }
<a name="l00220"></a>00220         <span class="keywordflow">else</span> {
<a name="l00221"></a>00221                 <a class="code" href="rpdb_8c.html#3300a3ed9f0b36062e6a79ffb2e1d316">guess_element</a>(name, symbol) ;
<a name="l00222"></a>00222                 *guess_flag+=1;
<a name="l00223"></a>00223         }
<a name="l00224"></a>00224         <a class="code" href="utils_8c.html#ed930c5e93a75d90a96195282790d467">str_trim</a>(symbol); <span class="comment">/* remove spaces */</span>
<a name="l00225"></a>00225         
<a name="l00226"></a>00226         <span class="comment">/* Charge */</span>
<a name="l00227"></a>00227         <span class="keywordflow">if</span>(rlen &gt;= 79) {
<a name="l00228"></a>00228             <span class="keywordtype">char</span> buf[4] = <span class="stringliteral">"   "</span> ;
<a name="l00229"></a>00229                 <span class="keywordflow">if</span>((pdb_line[78] == <span class="charliteral">' '</span> &amp;&amp; pdb_line[79] == <span class="charliteral">' '</span>) || pdb_line[78] == <span class="charliteral">'\n'</span>){
<a name="l00230"></a>00230                         *charge = 0 ;
<a name="l00231"></a>00231                 }
<a name="l00232"></a>00232                 <span class="keywordflow">else</span> {
<a name="l00233"></a>00233                         buf[0] = pdb_line[78] ;
<a name="l00234"></a>00234                         buf[1] = pdb_line[79] ;
<a name="l00235"></a>00235                         buf[2] = <span class="charliteral">'\0'</span> ;
<a name="l00236"></a>00236                         *charge = (int) atoi(buf) ;
<a name="l00237"></a>00237                 }
<a name="l00238"></a>00238         }
<a name="l00239"></a>00239         <span class="keywordflow">else</span> *charge = 0 ;
<a name="l00240"></a>00240         
<a name="l00241"></a>00241 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="29ed3bff6fdc59fd8bf806a35c3127d7"></a><!-- doxytag: member="rpdb.h::rpdb_open" ref="29ed3bff6fdc59fd8bf806a35c3127d7" args="(char *fpath, const char *ligan, const int keep_lig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structs__pdb.html">s_pdb</a>* rpdb_open           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ligan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>keep_lig</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_open<p>
## SPECIFICATION: Open a PDB file, alloc memory for all information on this pdb, and store several information like the number of atoms, the header, the remark... This first reading of PDB rewinds the FILE* pointer. No coordinates are actually read.<p>
Hydrogens are conserved. All HETATM are removed, except the given ligand if we have to keep it, and important HETATM listed in the static structure at the top of this file.<p>
## PARAMETRES: @ const char *fpath : The pdb path. @ const char *ligan : Ligand resname. @ const char *keep_lig : Keep the given ligand or not?<p>
## RETURN: <a class="el" href="structs__pdb.html">s_pdb</a>: data containing PDB info. 
<p>Definition at line <a class="el" href="rpdb_8c_source.html#l00512">512</a> of file <a class="el" href="rpdb_8c_source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l00661">fopen_pdb_check_case()</a>, <a class="el" href="rpdb_8h_source.html#l00070">s_pdb::fpdb</a>, <a class="el" href="rpdb_8h_source.html#l00076">s_pdb::latm_lig</a>, <a class="el" href="rpdb_8h_source.html#l00072">s_pdb::latoms</a>, <a class="el" href="rpdb_8h_source.html#l00074">s_pdb::latoms_p</a>, <a class="el" href="rpdb_8h_source.html#l00075">s_pdb::lhetatm</a>, <a class="el" href="rpdb_8h_source.html#l00047">M_PDB_BUF_LEN</a>, <a class="el" href="rpdb_8h_source.html#l00046">M_PDB_LINE_LEN</a>, <a class="el" href="memhandler_8c_source.html#l00153">my_calloc()</a>, <a class="el" href="memhandler_8c_source.html#l00255">my_free()</a>, <a class="el" href="memhandler_8c_source.html#l00121">my_malloc()</a>, <a class="el" href="rpdb_8h_source.html#l00078">s_pdb::natm_lig</a>, <a class="el" href="rpdb_8h_source.html#l00078">s_pdb::natoms</a>, <a class="el" href="rpdb_8h_source.html#l00078">s_pdb::nhetatm</a>, <a class="el" href="rpdb_8c_source.html#l00366">rpdb_extract_atm_resname()</a>, <a class="el" href="rpdb_8c_source.html#l00085">ST_keep_hetatm</a>, and <a class="el" href="rpdb_8c_source.html#l00100">ST_nb_keep_hetatm</a>.</p>

<p>Referenced by <a class="el" href="check_8c_source.html#l00105">check_fpocket()</a>, <a class="el" href="dpocket_8c_source.html#l00184">desc_pocket()</a>, <a class="el" href="fpmain_8c_source.html#l00129">process_pdb()</a>, and <a class="el" href="tpocket_8c_source.html#l00440">test_set()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00513"></a>00513 {
<a name="l00514"></a>00514         <a class="code" href="structs__pdb.html">s_pdb</a> *pdb = NULL ;
<a name="l00515"></a>00515 
<a name="l00516"></a>00516         <span class="keywordtype">char</span> buf[<a class="code" href="rpdb_8h.html#ce73bc2986adaa1837bc97e2757f1bb5">M_PDB_BUF_LEN</a>],
<a name="l00517"></a>00517                  resb[5] ;
<a name="l00518"></a>00518         
<a name="l00519"></a>00519         <span class="keywordtype">int</span> nhetatm = 0,
<a name="l00520"></a>00520                 natoms = 0,
<a name="l00521"></a>00521                 natm_lig = 0 ;
<a name="l00522"></a>00522         <span class="keywordtype">int</span> i ;
<a name="l00523"></a>00523         
<a name="l00524"></a>00524         pdb = (<a class="code" href="structs__pdb.html">s_pdb</a> *) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structs__pdb.html">s_pdb</a>)) ; ;
<a name="l00525"></a>00525         
<a name="l00526"></a>00526         <span class="comment">/* Open the PDB file in read-only mode */</span>
<a name="l00527"></a>00527         pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a> = <a class="code" href="utils_8c.html#8ec5b0b9f097dc4fc2807ca47d242ac9">fopen_pdb_check_case</a>(fpath, <span class="stringliteral">"r"</span>);
<a name="l00528"></a>00528         <span class="keywordflow">if</span> (!pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>) {
<a name="l00529"></a>00529                 <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb) ;
<a name="l00530"></a>00530                 fprintf(stderr, <span class="stringliteral">"! File %s does not exist\n"</span>, fpath) ;
<a name="l00531"></a>00531                 <span class="keywordflow">return</span> NULL ;
<a name="l00532"></a>00532         }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534         <span class="keywordflow">while</span>(fgets(buf, <a class="code" href="rpdb_8h.html#81915efba694ad7576ecf5768b66a318">M_PDB_LINE_LEN</a> + 2, pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>)) {
<a name="l00535"></a>00535                 <span class="keywordflow">if</span> (!strncmp(buf, <span class="stringliteral">"ATOM "</span>,  5)) {
<a name="l00536"></a>00536                 <span class="comment">/* Check if this is the first occurence of this atom*/</span>
<a name="l00537"></a>00537                         <span class="keywordflow">if</span>(buf[16]==<span class="charliteral">' '</span> || buf[16]==<span class="charliteral">'A'</span>){  
<a name="l00538"></a>00538                         <span class="comment">/* Atom entry: check if there is a ligand in there (just in case)... */</span>
<a name="l00539"></a>00539                                 <a class="code" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a>(buf, resb) ;
<a name="l00540"></a>00540                                 <span class="keywordflow">if</span>( ligan &amp;&amp; ligan[0] == resb[0] &amp;&amp; ligan[1] == resb[1] 
<a name="l00541"></a>00541                                         &amp;&amp; ligan[2] == resb[2]){
<a name="l00542"></a>00542 
<a name="l00543"></a>00543                                         <span class="keywordflow">if</span>(keep_lig) {
<a name="l00544"></a>00544                                                 natm_lig ++ ;
<a name="l00545"></a>00545                                                 natoms++ ;
<a name="l00546"></a>00546                                         }
<a name="l00547"></a>00547                                 }
<a name="l00548"></a>00548                                 <span class="keywordflow">else</span> {
<a name="l00549"></a>00549                                         natoms++ ;
<a name="l00550"></a>00550                                 }
<a name="l00551"></a>00551                         }
<a name="l00552"></a>00552                 }
<a name="l00553"></a>00553                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(buf, <span class="stringliteral">"HETATM"</span>, 6)) {
<a name="l00554"></a>00554                         <span class="comment">/*Check again for the first occurence*/</span>
<a name="l00555"></a>00555                         <span class="keywordflow">if</span>(buf[16]==<span class="charliteral">' '</span> || buf[16]==<span class="charliteral">'A'</span>){ 
<a name="l00556"></a>00556                                 <span class="comment">/* Hetatom entry: check if there is a ligand in there too... */</span>
<a name="l00557"></a>00557                                 <a class="code" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a>(buf, resb) ;
<a name="l00558"></a>00558                                 <span class="keywordflow">if</span>( keep_lig &amp;&amp; ligan &amp;&amp; ligan[0] == resb[0] &amp;&amp; ligan[1] == resb[1] 
<a name="l00559"></a>00559                                         &amp;&amp; ligan[2] == resb[2]){
<a name="l00560"></a>00560                                         natm_lig ++ ; natoms++ ;
<a name="l00561"></a>00561                                 }
<a name="l00562"></a>00562                                 <span class="keywordflow">else</span> {
<a name="l00563"></a>00563                                 <span class="comment">/* Keep specific HETATM given in the static list ST_keep_hetatm */</span>
<a name="l00564"></a>00564                                         <span class="keywordflow">for</span>(i = 0 ; i &lt; <a class="code" href="rpdb_8c.html#538712c3db672b5bd078348a0b541047">ST_nb_keep_hetatm</a> ; i++) {
<a name="l00565"></a>00565                                                         <span class="keywordflow">if</span>(<a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][0] == resb[0] &amp;&amp; <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][1]
<a name="l00566"></a>00566                                                                 == resb[1] &amp;&amp; <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][2] == resb[2]) {
<a name="l00567"></a>00567                                                                         nhetatm++ ; natoms++ ;
<a name="l00568"></a>00568                                                                         break ;
<a name="l00569"></a>00569                                                         }
<a name="l00570"></a>00570                                         }
<a name="l00571"></a>00571                                 }
<a name="l00572"></a>00572                         }
<a name="l00573"></a>00573                 }
<a name="l00574"></a>00574 <span class="comment">/*</span>
<a name="l00575"></a>00575 <span class="comment">                else if (!strncmp(buf, "HEADER", 6)) </span>
<a name="l00576"></a>00576 <span class="comment">                        strncpy(pdb-&gt;header, buf, M_PDB_BUF_LEN) ;</span>
<a name="l00577"></a>00577 <span class="comment">*/</span>
<a name="l00578"></a>00578                 
<a name="l00579"></a>00579                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(buf, <span class="stringliteral">"END"</span>, 3)) break ;
<a name="l00580"></a>00580         }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582         <span class="keywordflow">if</span> (natoms == 0) {
<a name="l00583"></a>00583                 fprintf(stderr, <span class="stringliteral">"! File '%s' contains no atoms...\n"</span>, fpath) ;
<a name="l00584"></a>00584                 <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb) ;
<a name="l00585"></a>00585         
<a name="l00586"></a>00586                 <span class="keywordflow">return</span> NULL ;
<a name="l00587"></a>00587         }
<a name="l00588"></a>00588 
<a name="l00589"></a>00589         <span class="comment">/* Alloc needed memory */</span>
<a name="l00590"></a>00590         pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a> = (<a class="code" href="structs__atm.html">s_atm</a>*) <a class="code" href="memhandler_8c.html#e1a54755aeeb11b927875d686a5248c7">my_calloc</a>(natoms, <span class="keyword">sizeof</span>(<a class="code" href="structs__atm.html">s_atm</a>)) ;
<a name="l00591"></a>00591         pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a> = (<a class="code" href="structs__atm.html">s_atm</a>**) <a class="code" href="memhandler_8c.html#e1a54755aeeb11b927875d686a5248c7">my_calloc</a>(natoms, <span class="keyword">sizeof</span>(<a class="code" href="structs__atm.html">s_atm</a>*)) ;
<a name="l00592"></a>00592 
<a name="l00593"></a>00593         <span class="keywordflow">if</span>(nhetatm &gt; 0) pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a> = (<a class="code" href="structs__atm.html">s_atm</a>**) <a class="code" href="memhandler_8c.html#e1a54755aeeb11b927875d686a5248c7">my_calloc</a>(nhetatm, <span class="keyword">sizeof</span>(<a class="code" href="structs__atm.html">s_atm</a>*)) ;
<a name="l00594"></a>00594         <span class="keywordflow">else</span> pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a> = NULL ;
<a name="l00595"></a>00595         
<a name="l00596"></a>00596         <span class="keywordflow">if</span>(natm_lig &gt; 0) pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a> = (<a class="code" href="structs__atm.html">s_atm</a>**) <a class="code" href="memhandler_8c.html#e1a54755aeeb11b927875d686a5248c7">my_calloc</a>(natm_lig, <span class="keyword">sizeof</span>(<a class="code" href="structs__atm.html">s_atm</a>*)) ;
<a name="l00597"></a>00597         <span class="keywordflow">else</span> pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a> = NULL ;
<a name="l00598"></a>00598         
<a name="l00599"></a>00599         pdb-&gt;<a class="code" href="structs__pdb.html#85aaf7bdb931bb303af1ca736a998b98">natoms</a> = natoms ;
<a name="l00600"></a>00600         pdb-&gt;<a class="code" href="structs__pdb.html#2e9c327d5029e032b77a67664d6466a7">nhetatm</a> = nhetatm ;
<a name="l00601"></a>00601         pdb-&gt;<a class="code" href="structs__pdb.html#659b83804ffc576f1307beac00c1486b">natm_lig</a> = natm_lig ;
<a name="l00602"></a>00602         rewind(pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>) ;
<a name="l00603"></a>00603 
<a name="l00604"></a>00604         <span class="keywordflow">return</span> pdb ;
<a name="l00605"></a>00605 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1ec399102f369c72b06a9944616715b0"></a><!-- doxytag: member="rpdb.h::rpdb_read" ref="1ec399102f369c72b06a9944616715b0" args="(s_pdb *pdb, const char *ligan, const int keep_lig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rpdb_read           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__pdb.html">s_pdb</a> *&nbsp;</td>
          <td class="paramname"> <em>pdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ligan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>keep_lig</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_read<p>
## SPECIFICATION: Read and store information on atoms for a pdb file. Curently:<ul>
<li>Hydrogens present in the PDB are kept</li><li>HETATM are ignored except for specific cofactor, small molecule... listed in ST_keep_hetatm variable, and for a given ligand, defined by its resname.</li><li>Solvent molecules are ignored</li></ul>
<p>
## PARAMETRES: @ <a class="el" href="structs__pdb.html">s_pdb</a> *pdb : The structure to fill @ const char *ligand : The ligand resname @ const char *keep_lig : Keep the given ligand or not?<p>
## RETURN: 
<p>Definition at line <a class="el" href="rpdb_8c_source.html#l00628">628</a> of file <a class="el" href="rpdb_8c_source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="rpdb_8h_source.html#l00082">s_pdb::A</a>, <a class="el" href="rpdb_8h_source.html#l00082">s_pdb::alpha</a>, <a class="el" href="rpdb_8h_source.html#l00082">s_pdb::B</a>, <a class="el" href="rpdb_8h_source.html#l00082">s_pdb::beta</a>, <a class="el" href="atom_8h_source.html#l00070">s_atm::bfactor</a>, <a class="el" href="rpdb_8h_source.html#l00082">s_pdb::C</a>, <a class="el" href="atom_8h_source.html#l00057">s_atm::chain</a>, <a class="el" href="atom_8h_source.html#l00063">s_atm::charge</a>, <a class="el" href="atom_8h_source.html#l00070">s_atm::electroneg</a>, <a class="el" href="rpdb_8h_source.html#l00070">s_pdb::fpdb</a>, <a class="el" href="rpdb_8h_source.html#l00082">s_pdb::gamma</a>, <a class="el" href="atom_8h_source.html#l00063">s_atm::id</a>, <a class="el" href="rpdb_8h_source.html#l00076">s_pdb::latm_lig</a>, <a class="el" href="rpdb_8h_source.html#l00072">s_pdb::latoms</a>, <a class="el" href="rpdb_8h_source.html#l00074">s_pdb::latoms_p</a>, <a class="el" href="rpdb_8h_source.html#l00075">s_pdb::lhetatm</a>, <a class="el" href="rpdb_8h_source.html#l00047">M_PDB_BUF_LEN</a>, <a class="el" href="rpdb_8h_source.html#l00046">M_PDB_LINE_LEN</a>, <a class="el" href="atom_8h_source.html#l00070">s_atm::mass</a>, <a class="el" href="atom_8h_source.html#l00057">s_atm::name</a>, <a class="el" href="rpdb_8h_source.html#l00078">s_pdb::natm_lig</a>, <a class="el" href="atom_8h_source.html#l00070">s_atm::occupancy</a>, <a class="el" href="atom_8h_source.html#l00076">s_atm::pdb_aloc</a>, <a class="el" href="atom_8h_source.html#l00076">s_atm::pdb_insert</a>, <a class="el" href="pertable_8c_source.html#l00223">pte_get_enegativity()</a>, <a class="el" href="pertable_8c_source.html#l00154">pte_get_mass()</a>, <a class="el" href="pertable_8c_source.html#l00189">pte_get_vdw_ray()</a>, <a class="el" href="atom_8h_source.html#l00070">s_atm::radius</a>, <a class="el" href="atom_8h_source.html#l00063">s_atm::res_id</a>, <a class="el" href="atom_8h_source.html#l00057">s_atm::res_name</a>, <a class="el" href="rpdb_8c_source.html#l00366">rpdb_extract_atm_resname()</a>, <a class="el" href="rpdb_8c_source.html#l00450">rpdb_extract_cryst1()</a>, <a class="el" href="rpdb_8c_source.html#l00156">rpdb_extract_pdb_atom()</a>, <a class="el" href="atom_8h_source.html#l00054">s_atm::sort_x</a>, <a class="el" href="rpdb_8c_source.html#l00085">ST_keep_hetatm</a>, <a class="el" href="rpdb_8c_source.html#l00100">ST_nb_keep_hetatm</a>, <a class="el" href="atom_8h_source.html#l00057">s_atm::symbol</a>, <a class="el" href="atom_8h_source.html#l00057">s_atm::type</a>, <a class="el" href="atom_8h_source.html#l00056">s_atm::x</a>, <a class="el" href="atom_8h_source.html#l00056">s_atm::y</a>, and <a class="el" href="atom_8h_source.html#l00056">s_atm::z</a>.</p>

<p>Referenced by <a class="el" href="check_8c_source.html#l00105">check_fpocket()</a>, <a class="el" href="dpocket_8c_source.html#l00184">desc_pocket()</a>, <a class="el" href="fpmain_8c_source.html#l00129">process_pdb()</a>, and <a class="el" href="tpocket_8c_source.html#l00440">test_set()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00629"></a>00629 {
<a name="l00630"></a>00630         <span class="keywordtype">int</span> i,
<a name="l00631"></a>00631                 iatoms,
<a name="l00632"></a>00632                 ihetatm,
<a name="l00633"></a>00633                 iatm_lig,
<a name="l00634"></a>00634                 ligfound ;
<a name="l00635"></a>00635 
<a name="l00636"></a>00636         <span class="keywordtype">char</span> pdb_line[<a class="code" href="rpdb_8h.html#ce73bc2986adaa1837bc97e2757f1bb5">M_PDB_BUF_LEN</a>],
<a name="l00637"></a>00637                  resb[5] ;                                      <span class="comment">/* Buffer for the current residue name */</span>
<a name="l00638"></a>00638 
<a name="l00639"></a>00639         <a class="code" href="structs__atm.html">s_atm</a> *atom = NULL ;
<a name="l00640"></a>00640         <a class="code" href="structs__atm.html">s_atm</a> *atoms = pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a> ;
<a name="l00641"></a>00641         <a class="code" href="structs__atm.html">s_atm</a> **atoms_p = pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a> ;
<a name="l00642"></a>00642         <a class="code" href="structs__atm.html">s_atm</a> **atm_lig = pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a> ;
<a name="l00643"></a>00643         <span class="keywordtype">int</span> guess_flag=0;
<a name="l00644"></a>00644         iatoms = 0 ;
<a name="l00645"></a>00645         ihetatm = 0 ;
<a name="l00646"></a>00646         iatm_lig = 0 ;
<a name="l00647"></a>00647         ligfound = 0 ;
<a name="l00648"></a>00648 
<a name="l00649"></a>00649         <span class="comment">/* Loop over the pdb file */</span> 
<a name="l00650"></a>00650         <span class="keywordflow">while</span>(fgets(pdb_line, <a class="code" href="rpdb_8h.html#81915efba694ad7576ecf5768b66a318">M_PDB_LINE_LEN</a> + 2, pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>)) {
<a name="l00651"></a>00651                 <span class="keywordflow">if</span> (strncmp(pdb_line, <span class="stringliteral">"ATOM "</span>,  5) == 0) {
<a name="l00652"></a>00652                         <span class="keywordflow">if</span>(pdb_line[16]==<span class="charliteral">' '</span> || pdb_line[16]==<span class="charliteral">'A'</span>){ <span class="comment">/*if within first occurence*/</span>
<a name="l00653"></a>00653                                 <span class="comment">/* Store ATOM entry */</span>
<a name="l00654"></a>00654                                 <a class="code" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a>(pdb_line, resb) ;
<a name="l00655"></a>00655                                 <span class="comment">/* Check if the desired ligand is in such entry */</span>
<a name="l00656"></a>00656                                 <span class="keywordflow">if</span>( ligan &amp;&amp; ligan[0] == resb[0] &amp;&amp; ligan[1] == resb[1] 
<a name="l00657"></a>00657                                         &amp;&amp; ligan[2] == resb[2]){
<a name="l00658"></a>00658                                         <span class="keywordflow">if</span>(keep_lig) {
<a name="l00659"></a>00659                                                 atom = atoms + iatoms ;
<a name="l00660"></a>00660                                                 
<a name="l00661"></a>00661                                                 <span class="comment">/* Read atom information */</span>
<a name="l00662"></a>00662                                                 <a class="code" href="rpdb_8c.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a>(pdb_line, atom-&gt;<a class="code" href="structs__atm.html#98466fdfcb021884beb229b1dca361ae">type</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>), 
<a name="l00663"></a>00663                                                                 atom-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#58eeb8a80942caa3bd2374f3175cb77d">pdb_aloc</a>), atom-&gt;<a class="code" href="structs__atm.html#e0ff20f2c491a8b16c866d9b1386b6a5">res_name</a>, 
<a name="l00664"></a>00664                                                                 atom-&gt;<a class="code" href="structs__atm.html#c5b9464bd67f2cca101f7bf6beabb223">chain</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#bfd1f905200f69dd9cd9750fd305cf46">pdb_insert</a>), 
<a name="l00665"></a>00665                                                                 &amp;(atom-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>), 
<a name="l00666"></a>00666                                                                 &amp;(atom-&gt;<a class="code" href="structs__atm.html#1696926c680a1014360598d54a1dadb0">occupancy</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a>), atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>,
<a name="l00667"></a>00667                                                                 &amp;(atom-&gt;<a class="code" href="structs__atm.html#a03a199ed11108d7710547df629c7d73">charge</a>), &amp;guess_flag);
<a name="l00668"></a>00668 
<a name="l00669"></a>00669                                                 <span class="comment">/* Store additional information not given in the pdb */</span>
<a name="l00670"></a>00670                                                 atom-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> = <a class="code" href="pertable_8c.html#3eeaf52663f6057aee4f869d5c78a8c8">pte_get_mass</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00671"></a>00671                                                 atom-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> = <a class="code" href="pertable_8c.html#e4452b6c03cdbc3ea402b7f4ef183eee">pte_get_vdw_ray</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00672"></a>00672                                                 atom-&gt;<a class="code" href="structs__atm.html#f41b525ee3032d47baf2db10387f022c">electroneg</a> = <a class="code" href="pertable_8c.html#5dda7fa72655b6d311e2a41ef049d5d6">pte_get_enegativity</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00673"></a>00673                                                 atom-&gt;<a class="code" href="structs__atm.html#05407d7638ff7f6fc210026306def9b5">sort_x</a> = -1 ;
<a name="l00674"></a>00674                                                 
<a name="l00675"></a>00675                                                 atoms_p[iatoms] = atom ;
<a name="l00676"></a>00676                                                 iatoms++ ;
<a name="l00677"></a>00677 
<a name="l00678"></a>00678                                                 atm_lig[iatm_lig] = atom ;
<a name="l00679"></a>00679                                                 iatm_lig ++ ;
<a name="l00680"></a>00680                                                 ligfound = 1 ;
<a name="l00681"></a>00681                                         }
<a name="l00682"></a>00682                                 }
<a name="l00683"></a>00683                                 <span class="keywordflow">else</span> {
<a name="l00684"></a>00684                                 <span class="comment">/* A simple atom not supposed to be stored as a ligand */</span>
<a name="l00685"></a>00685                                         atom = atoms + iatoms ;
<a name="l00686"></a>00686                                         <a class="code" href="rpdb_8c.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a>(pdb_line, atom-&gt;<a class="code" href="structs__atm.html#98466fdfcb021884beb229b1dca361ae">type</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>), 
<a name="l00687"></a>00687                                                         atom-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#58eeb8a80942caa3bd2374f3175cb77d">pdb_aloc</a>), atom-&gt;<a class="code" href="structs__atm.html#e0ff20f2c491a8b16c866d9b1386b6a5">res_name</a>, 
<a name="l00688"></a>00688                                                         atom-&gt;<a class="code" href="structs__atm.html#c5b9464bd67f2cca101f7bf6beabb223">chain</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#bfd1f905200f69dd9cd9750fd305cf46">pdb_insert</a>), 
<a name="l00689"></a>00689                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#1696926c680a1014360598d54a1dadb0">occupancy</a>), 
<a name="l00690"></a>00690                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a>), atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#a03a199ed11108d7710547df629c7d73">charge</a>), &amp;guess_flag);
<a name="l00691"></a>00691 
<a name="l00692"></a>00692                                         <span class="comment">/* Store additional information not given in the pdb */</span>
<a name="l00693"></a>00693                                         atom-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> = <a class="code" href="pertable_8c.html#3eeaf52663f6057aee4f869d5c78a8c8">pte_get_mass</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00694"></a>00694                                         atom-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> = <a class="code" href="pertable_8c.html#e4452b6c03cdbc3ea402b7f4ef183eee">pte_get_vdw_ray</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00695"></a>00695                                         atom-&gt;<a class="code" href="structs__atm.html#f41b525ee3032d47baf2db10387f022c">electroneg</a> = <a class="code" href="pertable_8c.html#5dda7fa72655b6d311e2a41ef049d5d6">pte_get_enegativity</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00696"></a>00696                                         atom-&gt;<a class="code" href="structs__atm.html#05407d7638ff7f6fc210026306def9b5">sort_x</a> = -1 ;
<a name="l00697"></a>00697 
<a name="l00698"></a>00698                                         atoms_p[iatoms] = atom ;
<a name="l00699"></a>00699                                         iatoms++ ;
<a name="l00700"></a>00700                                 }
<a name="l00701"></a>00701                         }
<a name="l00702"></a>00702                 }
<a name="l00703"></a>00703                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strncmp(pdb_line, <span class="stringliteral">"HETATM"</span>, 6) == 0) {
<a name="l00704"></a>00704                         <span class="keywordflow">if</span>(pdb_line[16]==<span class="charliteral">' '</span> || pdb_line[16]==<span class="charliteral">'A'</span>){<span class="comment">/*first occurence*/</span>
<a name="l00705"></a>00705                                 <span class="comment">/* Check HETATM entry */</span>
<a name="l00706"></a>00706                                 <a class="code" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a>(pdb_line, resb) ;
<a name="l00707"></a>00707                                 <span class="comment">/* Check if the desired ligand is in HETATM entry */</span>
<a name="l00708"></a>00708                                 <span class="keywordflow">if</span>( ligan &amp;&amp; keep_lig &amp;&amp; ligan[0] == resb[0] &amp;&amp; ligan[1] == resb[1] 
<a name="l00709"></a>00709                                         &amp;&amp; ligan[2] == resb[2]){
<a name="l00710"></a>00710 
<a name="l00711"></a>00711                                         atom = atoms + iatoms ;
<a name="l00712"></a>00712                                         <a class="code" href="rpdb_8c.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a>(pdb_line, atom-&gt;<a class="code" href="structs__atm.html#98466fdfcb021884beb229b1dca361ae">type</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>), 
<a name="l00713"></a>00713                                                         atom-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#58eeb8a80942caa3bd2374f3175cb77d">pdb_aloc</a>), atom-&gt;<a class="code" href="structs__atm.html#e0ff20f2c491a8b16c866d9b1386b6a5">res_name</a>, 
<a name="l00714"></a>00714                                                         atom-&gt;<a class="code" href="structs__atm.html#c5b9464bd67f2cca101f7bf6beabb223">chain</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#bfd1f905200f69dd9cd9750fd305cf46">pdb_insert</a>), 
<a name="l00715"></a>00715                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#1696926c680a1014360598d54a1dadb0">occupancy</a>), 
<a name="l00716"></a>00716                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a>), atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#a03a199ed11108d7710547df629c7d73">charge</a>), &amp;guess_flag);
<a name="l00717"></a>00717 
<a name="l00718"></a>00718                                         <span class="comment">/* Store additional information not given in the pdb */</span>
<a name="l00719"></a>00719                                         atom-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> = <a class="code" href="pertable_8c.html#3eeaf52663f6057aee4f869d5c78a8c8">pte_get_mass</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00720"></a>00720                                         atom-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> = <a class="code" href="pertable_8c.html#e4452b6c03cdbc3ea402b7f4ef183eee">pte_get_vdw_ray</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00721"></a>00721                                         atom-&gt;<a class="code" href="structs__atm.html#f41b525ee3032d47baf2db10387f022c">electroneg</a> = <a class="code" href="pertable_8c.html#5dda7fa72655b6d311e2a41ef049d5d6">pte_get_enegativity</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00722"></a>00722                                         atom-&gt;<a class="code" href="structs__atm.html#05407d7638ff7f6fc210026306def9b5">sort_x</a> = -1 ;
<a name="l00723"></a>00723 
<a name="l00724"></a>00724                                         atoms_p[iatoms] = atom ;
<a name="l00725"></a>00725                                         atm_lig[iatm_lig] = atom ;
<a name="l00726"></a>00726                                         
<a name="l00727"></a>00727                                         iatm_lig ++ ; iatoms++ ;
<a name="l00728"></a>00728                                         ligfound = 1 ;
<a name="l00729"></a>00729                                 }
<a name="l00730"></a>00730                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a>) {
<a name="l00731"></a>00731                                 <span class="comment">/* Keep specific HETATM given in the static list ST_keep_hetatm. */</span>
<a name="l00732"></a>00732                                         <span class="keywordflow">for</span>(i = 0 ; i &lt; <a class="code" href="rpdb_8c.html#538712c3db672b5bd078348a0b541047">ST_nb_keep_hetatm</a> ; i++) {
<a name="l00733"></a>00733                                                 <span class="keywordflow">if</span>( <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][0] == resb[0] &amp;&amp; <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][1] 
<a name="l00734"></a>00734                                                         == resb[1] &amp;&amp; <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][2] == resb[2]) {
<a name="l00735"></a>00735                                                         atom = atoms + iatoms ;
<a name="l00736"></a>00736                                                         <a class="code" href="rpdb_8c.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a>(pdb_line, atom-&gt;<a class="code" href="structs__atm.html#98466fdfcb021884beb229b1dca361ae">type</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>), 
<a name="l00737"></a>00737                                                                         atom-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#58eeb8a80942caa3bd2374f3175cb77d">pdb_aloc</a>), atom-&gt;<a class="code" href="structs__atm.html#e0ff20f2c491a8b16c866d9b1386b6a5">res_name</a>, 
<a name="l00738"></a>00738                                                                         atom-&gt;<a class="code" href="structs__atm.html#c5b9464bd67f2cca101f7bf6beabb223">chain</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#bfd1f905200f69dd9cd9750fd305cf46">pdb_insert</a>), 
<a name="l00739"></a>00739                                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>), 
<a name="l00740"></a>00740                                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#1696926c680a1014360598d54a1dadb0">occupancy</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a>), 
<a name="l00741"></a>00741                                                                         atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#a03a199ed11108d7710547df629c7d73">charge</a>), &amp;guess_flag);
<a name="l00742"></a>00742 
<a name="l00743"></a>00743                                                 <span class="comment">/* Store additional information not given in the pdb */</span>
<a name="l00744"></a>00744                                                         atom-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> = <a class="code" href="pertable_8c.html#3eeaf52663f6057aee4f869d5c78a8c8">pte_get_mass</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00745"></a>00745                                                         atom-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> = <a class="code" href="pertable_8c.html#e4452b6c03cdbc3ea402b7f4ef183eee">pte_get_vdw_ray</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00746"></a>00746                                                         atom-&gt;<a class="code" href="structs__atm.html#f41b525ee3032d47baf2db10387f022c">electroneg</a> = <a class="code" href="pertable_8c.html#5dda7fa72655b6d311e2a41ef049d5d6">pte_get_enegativity</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00747"></a>00747                                                         atom-&gt;<a class="code" href="structs__atm.html#05407d7638ff7f6fc210026306def9b5">sort_x</a> = -1 ;
<a name="l00748"></a>00748                                                         
<a name="l00749"></a>00749                                                         atoms_p[iatoms] = atom ;
<a name="l00750"></a>00750                                                         pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a>[ihetatm] = atom ;
<a name="l00751"></a>00751                                                         ihetatm ++ ; iatoms++ ;
<a name="l00752"></a>00752                                                         break ;
<a name="l00753"></a>00753                                                 }
<a name="l00754"></a>00754                                         }
<a name="l00755"></a>00755                                 }
<a name="l00756"></a>00756                         }
<a name="l00757"></a>00757                 }
<a name="l00758"></a>00758                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(pdb_line, <span class="stringliteral">"CRYST1"</span>,  6) == 0)  {
<a name="l00759"></a>00759                         <a class="code" href="rpdb_8c.html#a1aa3ec53cf98fa511b7a2b320839350">rpdb_extract_cryst1</a>(pdb_line, &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#68ced10f4d2d6f8eff8e99750f816fb4">alpha</a>), &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#264782f353ab5791c4b2b213f78599a5">beta</a>), &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#b85054178fcffe54c253eaa81d422203">gamma</a>),
<a name="l00760"></a>00760                                                                          &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#c4ed1aee14eb31f82a90a7caadc69e4d">A</a>),  &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#539c9e10542bd3d0a3f4940ec0381f8f">B</a>), &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#4ba25329db7e91cbebfbb22a6c185ec6">C</a>));
<a name="l00761"></a>00761                 }
<a name="l00762"></a>00762                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(pdb_line, <span class="stringliteral">"END"</span>, 3)) break ;
<a name="l00763"></a>00763         }
<a name="l00764"></a>00764 
<a name="l00765"></a>00765        
<a name="l00766"></a>00766         <span class="keywordflow">if</span>(guess_flag&gt;0) {
<a name="l00767"></a>00767             fprintf(stderr, <span class="stringliteral">"&gt;! Warning: You did not provide a standard PDB file.\nElements were guessed by fpocket, because not provided in the PDB file. \nThere is no guarantee on the results!\n"</span>);
<a name="l00768"></a>00768         }
<a name="l00769"></a>00769         
<a name="l00770"></a>00770         <span class="keywordflow">if</span>(ligan &amp;&amp; keep_lig &amp;&amp; (ligfound == 0 || pdb-&gt;<a class="code" href="structs__pdb.html#659b83804ffc576f1307beac00c1486b">natm_lig</a> &lt;= 0)) {
<a name="l00771"></a>00771                 fprintf(stderr, <span class="stringliteral">"&gt;! Warning: ligand '%s' not found in the pdb...\n"</span>, ligan) ;
<a name="l00772"></a>00772                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a>) fprintf(stderr, <span class="stringliteral">"! Ligand list is not NULL however...\n"</span>) ;
<a name="l00773"></a>00773                 <span class="keywordflow">if</span>(ligfound == 1) fprintf(stderr, <span class="stringliteral">"! And ligfound == 1!! :-/\n"</span>) ;
<a name="l00774"></a>00774         }
<a name="l00775"></a>00775         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ligfound == 1 &amp;&amp; iatm_lig &lt;= 0) {
<a name="l00776"></a>00776                 fprintf(stderr, <span class="stringliteral">"&gt;! Warning: ligand '%s' has been detected but no atoms \</span>
<a name="l00777"></a>00777 <span class="stringliteral">                                                has been stored!\n"</span>, ligan) ;
<a name="l00778"></a>00778         }
<a name="l00779"></a>00779         <span class="keywordflow">else</span> <span class="keywordflow">if</span>((ligfound == 1 &amp;&amp; pdb-&gt;<a class="code" href="structs__pdb.html#659b83804ffc576f1307beac00c1486b">natm_lig</a> &lt;= 0) || (pdb-&gt;<a class="code" href="structs__pdb.html#659b83804ffc576f1307beac00c1486b">natm_lig</a> &lt;=0 
<a name="l00780"></a>00780                          &amp;&amp; iatm_lig &gt; 0)) {
<a name="l00781"></a>00781                 fprintf(stderr, <span class="stringliteral">"&gt;! Warning: ligand '%s' has been detected in rpdb_read \</span>
<a name="l00782"></a>00782 <span class="stringliteral">                                                but not in rpdb_open!\n"</span>, ligan) ;
<a name="l00783"></a>00783         }
<a name="l00784"></a>00784 
<a name="l00785"></a>00785 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Jul 5 22:10:40 2009 for fpocket by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
